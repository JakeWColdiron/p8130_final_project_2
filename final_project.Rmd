---
title: "Final Project"
output: github_document
---

```{r}
library(gtsummary)
library(tidyverse)
library(car)
library(caret)

```

```{r}
data = read.csv("./data/data.csv")
# Convert character to factor for regression analysis
data_1 = data |>
  mutate(
    race = as.numeric(factor(race, levels = c("White", "Black", "Other"))) - 1,
    marital_status = as.numeric(factor(marital_status, levels = c("Married", "Single", "Divorced", "Widowed", "Separated"))) - 1,
    t_stage = as.numeric(factor(t_stage, levels = c("T1", "T2", "T3", "T4"))) - 1,
    n_stage = as.numeric(factor(n_stage, levels = c("N1", "N2", "N3"))) - 1,
    x6th_stage = as.numeric(factor(x6th_stage, levels = c("IIA", "IIB", "IIIA", "IIIB", "IIIC"))) - 1,
    differentiate = as.numeric(factor(differentiate, levels = c("Undifferentiated", "Poorly differentiated", "Moderately differentiated", "Well differentiated"))) - 1,
    a_stage = as.numeric(factor(a_stage, levels = c("Distant", "Regional"))) - 1,
    estrogen_status = as.numeric(factor(estrogen_status, levels = c("Negative", "Positive"))) - 1,
    progesterone_status = as.numeric(factor(progesterone_status, levels = c("Negative", "Positive"))) - 1,
    status = as.numeric(factor(status, levels = c("Alive", "Dead"))) - 1)
str(data_1)
colSums(is.na(data_1))
```
```


#Figure 1 
```{r}
proj2 %>%
tbl_summary(by="Status",
  missing_text = "(Missing)", # counts missing values
  statistic = list(all_continuous() ~ "mean={mean} (min={min}, max={max}, sd={sd})",
                   all_categorical() ~ "n={n} (p={p}%)") # stats for categorical
 # specify variables to include
  ) %>%
bold_labels()  %>%
italicize_levels()
```

#Find correlation
```{R}
```

#Model fitting
```{R}
null_model= glm(Status~1,family = binomial(link = "logit"), data = proj1)
model <- glm(Status ~ (Age* Race*Marital.Status + T.Stage + N.Stage + X6th.Stage +
                       differentiate + Grade + A.Stage + Tumor.Size + Estrogen.Status +
                       Progesterone.Status + Regional.Node.Examined + Reginol.Node.Positive),
             family = binomial(link = "logit"), data = proj1)


model <- glm(Status ~ (Age* Race*Marital.Status + T.Stage + N.Stage + X6th.Stage + Grade + A.Stage + Tumor.Size  + Regional.Node.Examined + Reginol.Node.Positive),
             family = binomial(link = "logit"), data = proj1)


step_model <- step(null_model, scope = list(lower = null_model, upper = model), 
                   direction = "forward")

step_model <- step(model, direction = "backward")
data = read_csv("./data/data.csv") |>
  janitor::clean_names()

summary(data)

str(data)
```

```{r}
# Check for missing data
colSums(is.na(data))
```



